---
# Initialize Postgres

    - name: Packages                   | Add Postgres repository
      when: ansible_os_family == 'RedHat'
      yum:
        name: https://yum.postgresql.org/10/redhat/rhel-6-x86_64/pgdg-redhat10-10-2.noarch.rpm
        state: installed

    - name: Postgres                   | Install Postgres
      when: ansible_os_family == 'RedHat'
      yum:
        name:
          - postgresql10-server
          - postgresql10-contrib
          - postgresql10
          - python-psycopg2
        state: installed

    - name: Postgres                   | Create Postgres data dir
      file: path={{ item }} state=directory owner=postgres group=postgres
      with_items:
        - /srv/postgres

    - name: Postgres                   | Create Postgres data cluster
      command: su postgres -c "/usr/pgsql-10/bin/initdb -D /srv/postgres"
